{"ast":null,"code":"/*\n * heatmap.js v2.0.5 | JavaScript Heatmap Library\n *\n * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.\n * Dual licensed under MIT and Beerware license \n *\n * :: 2016-09-05 01:16\n */\n;\n\n(function (name, context, factory) {\n  // Supports UMD. AMD, CommonJS/Node.js and browser context\n  if (typeof module !== \"undefined\" && module.exports) {\n    module.exports = factory();\n  } else if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else {\n    context[name] = factory();\n  }\n})(\"h337\", this, function () {\n  // Heatmap Config stores default values and will be merged with instance config\n  var HeatmapConfig = {\n    defaultRadius: 40,\n    defaultRenderer: 'canvas2d',\n    defaultGradient: {\n      0.25: \"rgb(0,0,255)\",\n      0.55: \"rgb(0,255,0)\",\n      0.85: \"yellow\",\n      1.0: \"rgb(255,0,0)\"\n    },\n    defaultMaxOpacity: 1,\n    defaultMinOpacity: 0,\n    defaultBlur: .85,\n    defaultXField: 'x',\n    defaultYField: 'y',\n    defaultValueField: 'value',\n    plugins: {}\n  };\n\n  var Store = function StoreClosure() {\n    var Store = function Store(config) {\n      this._coordinator = {};\n      this._data = [];\n      this._radi = [];\n      this._min = 10;\n      this._max = 1;\n      this._xField = config['xField'] || config.defaultXField;\n      this._yField = config['yField'] || config.defaultYField;\n      this._valueField = config['valueField'] || config.defaultValueField;\n\n      if (config[\"radius\"]) {\n        this._cfgRadius = config[\"radius\"];\n      }\n    };\n\n    var defaultRadius = HeatmapConfig.defaultRadius;\n    Store.prototype = {\n      // when forceRender = false -> called from setData, omits renderall event\n      _organiseData: function (dataPoint, forceRender) {\n        var x = dataPoint[this._xField];\n        var y = dataPoint[this._yField];\n        var radi = this._radi;\n        var store = this._data;\n        var max = this._max;\n        var min = this._min;\n        var value = dataPoint[this._valueField] || 1;\n        var radius = dataPoint.radius || this._cfgRadius || defaultRadius;\n\n        if (!store[x]) {\n          store[x] = [];\n          radi[x] = [];\n        }\n\n        if (!store[x][y]) {\n          store[x][y] = value;\n          radi[x][y] = radius;\n        } else {\n          store[x][y] += value;\n        }\n\n        var storedVal = store[x][y];\n\n        if (storedVal > max) {\n          if (!forceRender) {\n            this._max = storedVal;\n          } else {\n            this.setDataMax(storedVal);\n          }\n\n          return false;\n        } else if (storedVal < min) {\n          if (!forceRender) {\n            this._min = storedVal;\n          } else {\n            this.setDataMin(storedVal);\n          }\n\n          return false;\n        } else {\n          return {\n            x: x,\n            y: y,\n            value: value,\n            radius: radius,\n            min: min,\n            max: max\n          };\n        }\n      },\n      _unOrganizeData: function () {\n        var unorganizedData = [];\n        var data = this._data;\n        var radi = this._radi;\n\n        for (var x in data) {\n          for (var y in data[x]) {\n            unorganizedData.push({\n              x: x,\n              y: y,\n              radius: radi[x][y],\n              value: data[x][y]\n            });\n          }\n        }\n\n        return {\n          min: this._min,\n          max: this._max,\n          data: unorganizedData\n        };\n      },\n      _onExtremaChange: function () {\n        this._coordinator.emit('extremachange', {\n          min: this._min,\n          max: this._max\n        });\n      },\n      addData: function () {\n        if (arguments[0].length > 0) {\n          var dataArr = arguments[0];\n          var dataLen = dataArr.length;\n\n          while (dataLen--) {\n            this.addData.call(this, dataArr[dataLen]);\n          }\n        } else {\n          // add to store  \n          var organisedEntry = this._organiseData(arguments[0], true);\n\n          if (organisedEntry) {\n            // if it's the first datapoint initialize the extremas with it\n            if (this._data.length === 0) {\n              this._min = this._max = organisedEntry.value;\n            }\n\n            this._coordinator.emit('renderpartial', {\n              min: this._min,\n              max: this._max,\n              data: [organisedEntry]\n            });\n          }\n        }\n\n        return this;\n      },\n      setData: function (data) {\n        var dataPoints = data.data;\n        var pointsLen = dataPoints.length; // reset data arrays\n\n        this._data = [];\n        this._radi = [];\n\n        for (var i = 0; i < pointsLen; i++) {\n          this._organiseData(dataPoints[i], false);\n        }\n\n        this._max = data.max;\n        this._min = data.min || 0;\n\n        this._onExtremaChange();\n\n        this._coordinator.emit('renderall', this._getInternalData());\n\n        return this;\n      },\n      removeData: function () {// TODO: implement\n      },\n      setDataMax: function (max) {\n        this._max = max;\n\n        this._onExtremaChange();\n\n        this._coordinator.emit('renderall', this._getInternalData());\n\n        return this;\n      },\n      setDataMin: function (min) {\n        this._min = min;\n\n        this._onExtremaChange();\n\n        this._coordinator.emit('renderall', this._getInternalData());\n\n        return this;\n      },\n      setCoordinator: function (coordinator) {\n        this._coordinator = coordinator;\n      },\n      _getInternalData: function () {\n        return {\n          max: this._max,\n          min: this._min,\n          data: this._data,\n          radi: this._radi\n        };\n      },\n      getData: function () {\n        return this._unOrganizeData();\n      }\n      /*,\n        TODO: rethink.\n      getValueAt: function(point) {\n       var value;\n       var radius = 100;\n       var x = point.x;\n       var y = point.y;\n       var data = this._data;\n        if (data[x] && data[x][y]) {\n         return data[x][y];\n       } else {\n         var values = [];\n         // radial search for datapoints based on default radius\n         for(var distance = 1; distance < radius; distance++) {\n           var neighbors = distance * 2 +1;\n           var startX = x - distance;\n           var startY = y - distance;\n            for(var i = 0; i < neighbors; i++) {\n             for (var o = 0; o < neighbors; o++) {\n               if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {\n                 if (data[startY+i] && data[startY+i][startX+o]) {\n                   values.push(data[startY+i][startX+o]);\n                 }\n               } else {\n                 continue;\n               } \n             }\n           }\n         }\n         if (values.length > 0) {\n           return Math.max.apply(Math, values);\n         }\n       }\n       return false;\n      }*/\n\n    };\n    return Store;\n  }();\n\n  var Canvas2dRenderer = function Canvas2dRendererClosure() {\n    var _getColorPalette = function (config) {\n      var gradientConfig = config.gradient || config.defaultGradient;\n      var paletteCanvas = document.createElement('canvas');\n      var paletteCtx = paletteCanvas.getContext('2d');\n      paletteCanvas.width = 256;\n      paletteCanvas.height = 1;\n      var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);\n\n      for (var key in gradientConfig) {\n        gradient.addColorStop(key, gradientConfig[key]);\n      }\n\n      paletteCtx.fillStyle = gradient;\n      paletteCtx.fillRect(0, 0, 256, 1);\n      return paletteCtx.getImageData(0, 0, 256, 1).data;\n    };\n\n    var _getPointTemplate = function (radius, blurFactor) {\n      var tplCanvas = document.createElement('canvas');\n      var tplCtx = tplCanvas.getContext('2d');\n      var x = radius;\n      var y = radius;\n      tplCanvas.width = tplCanvas.height = radius * 2;\n\n      if (blurFactor == 1) {\n        tplCtx.beginPath();\n        tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);\n        tplCtx.fillStyle = 'rgba(0,0,0,1)';\n        tplCtx.fill();\n      } else {\n        var gradient = tplCtx.createRadialGradient(x, y, radius * blurFactor, x, y, radius);\n        gradient.addColorStop(0, 'rgba(0,0,0,1)');\n        gradient.addColorStop(1, 'rgba(0,0,0,0)');\n        tplCtx.fillStyle = gradient;\n        tplCtx.fillRect(0, 0, 2 * radius, 2 * radius);\n      }\n\n      return tplCanvas;\n    };\n\n    var _prepareData = function (data) {\n      var renderData = [];\n      var min = data.min;\n      var max = data.max;\n      var radi = data.radi;\n      var data = data.data;\n      var xValues = Object.keys(data);\n      var xValuesLen = xValues.length;\n\n      while (xValuesLen--) {\n        var xValue = xValues[xValuesLen];\n        var yValues = Object.keys(data[xValue]);\n        var yValuesLen = yValues.length;\n\n        while (yValuesLen--) {\n          var yValue = yValues[yValuesLen];\n          var value = data[xValue][yValue];\n          var radius = radi[xValue][yValue];\n          renderData.push({\n            x: xValue,\n            y: yValue,\n            value: value,\n            radius: radius\n          });\n        }\n      }\n\n      return {\n        min: min,\n        max: max,\n        data: renderData\n      };\n    };\n\n    function Canvas2dRenderer(config) {\n      var container = config.container;\n      var shadowCanvas = this.shadowCanvas = document.createElement('canvas');\n      var canvas = this.canvas = config.canvas || document.createElement('canvas');\n      var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];\n      var computed = getComputedStyle(config.container) || {};\n      canvas.className = 'heatmap-canvas';\n      this._width = canvas.width = shadowCanvas.width = config.width || +computed.width.replace(/px/, '');\n      this._height = canvas.height = shadowCanvas.height = config.height || +computed.height.replace(/px/, '');\n      this.shadowCtx = shadowCanvas.getContext('2d');\n      this.ctx = canvas.getContext('2d'); // @TODO:\n      // conditional wrapper\n\n      canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';\n      container.style.position = 'relative';\n      container.appendChild(canvas);\n      this._palette = _getColorPalette(config);\n      this._templates = {};\n\n      this._setStyles(config);\n    }\n\n    ;\n    Canvas2dRenderer.prototype = {\n      renderPartial: function (data) {\n        if (data.data.length > 0) {\n          this._drawAlpha(data);\n\n          this._colorize();\n        }\n      },\n      renderAll: function (data) {\n        // reset render boundaries\n        this._clear();\n\n        if (data.data.length > 0) {\n          this._drawAlpha(_prepareData(data));\n\n          this._colorize();\n        }\n      },\n      _updateGradient: function (config) {\n        this._palette = _getColorPalette(config);\n      },\n      updateConfig: function (config) {\n        if (config['gradient']) {\n          this._updateGradient(config);\n        }\n\n        this._setStyles(config);\n      },\n      setDimensions: function (width, height) {\n        this._width = width;\n        this._height = height;\n        this.canvas.width = this.shadowCanvas.width = width;\n        this.canvas.height = this.shadowCanvas.height = height;\n      },\n      _clear: function () {\n        this.shadowCtx.clearRect(0, 0, this._width, this._height);\n        this.ctx.clearRect(0, 0, this._width, this._height);\n      },\n      _setStyles: function (config) {\n        this._blur = config.blur == 0 ? 0 : config.blur || config.defaultBlur;\n\n        if (config.backgroundColor) {\n          this.canvas.style.backgroundColor = config.backgroundColor;\n        }\n\n        this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;\n        this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;\n        this._opacity = (config.opacity || 0) * 255;\n        this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;\n        this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;\n        this._useGradientOpacity = !!config.useGradientOpacity;\n      },\n      _drawAlpha: function (data) {\n        var min = this._min = data.min;\n        var max = this._max = data.max;\n        var data = data.data || [];\n        var dataLen = data.length; // on a point basis?\n\n        var blur = 1 - this._blur;\n\n        while (dataLen--) {\n          var point = data[dataLen];\n          var x = point.x;\n          var y = point.y;\n          var radius = point.radius; // if value is bigger than max\n          // use max as value\n\n          var value = Math.min(point.value, max);\n          var rectX = x - radius;\n          var rectY = y - radius;\n          var shadowCtx = this.shadowCtx;\n          var tpl;\n\n          if (!this._templates[radius]) {\n            this._templates[radius] = tpl = _getPointTemplate(radius, blur);\n          } else {\n            tpl = this._templates[radius];\n          } // value from minimum / value range\n          // => [0, 1]\n\n\n          var templateAlpha = (value - min) / (max - min); // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData\n\n          shadowCtx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;\n          shadowCtx.drawImage(tpl, rectX, rectY); // update renderBoundaries\n\n          if (rectX < this._renderBoundaries[0]) {\n            this._renderBoundaries[0] = rectX;\n          }\n\n          if (rectY < this._renderBoundaries[1]) {\n            this._renderBoundaries[1] = rectY;\n          }\n\n          if (rectX + 2 * radius > this._renderBoundaries[2]) {\n            this._renderBoundaries[2] = rectX + 2 * radius;\n          }\n\n          if (rectY + 2 * radius > this._renderBoundaries[3]) {\n            this._renderBoundaries[3] = rectY + 2 * radius;\n          }\n        }\n      },\n      _colorize: function () {\n        var x = this._renderBoundaries[0];\n        var y = this._renderBoundaries[1];\n        var width = this._renderBoundaries[2] - x;\n        var height = this._renderBoundaries[3] - y;\n        var maxWidth = this._width;\n        var maxHeight = this._height;\n        var opacity = this._opacity;\n        var maxOpacity = this._maxOpacity;\n        var minOpacity = this._minOpacity;\n        var useGradientOpacity = this._useGradientOpacity;\n\n        if (x < 0) {\n          x = 0;\n        }\n\n        if (y < 0) {\n          y = 0;\n        }\n\n        if (x + width > maxWidth) {\n          width = maxWidth - x;\n        }\n\n        if (y + height > maxHeight) {\n          height = maxHeight - y;\n        }\n\n        var img = this.shadowCtx.getImageData(x, y, width, height);\n        var imgData = img.data;\n        var len = imgData.length;\n        var palette = this._palette;\n\n        for (var i = 3; i < len; i += 4) {\n          var alpha = imgData[i];\n          var offset = alpha * 4;\n\n          if (!offset) {\n            continue;\n          }\n\n          var finalAlpha;\n\n          if (opacity > 0) {\n            finalAlpha = opacity;\n          } else {\n            if (alpha < maxOpacity) {\n              if (alpha < minOpacity) {\n                finalAlpha = minOpacity;\n              } else {\n                finalAlpha = alpha;\n              }\n            } else {\n              finalAlpha = maxOpacity;\n            }\n          }\n\n          imgData[i - 3] = palette[offset];\n          imgData[i - 2] = palette[offset + 1];\n          imgData[i - 1] = palette[offset + 2];\n          imgData[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;\n        }\n\n        img.data = imgData;\n        this.ctx.putImageData(img, x, y);\n        this._renderBoundaries = [1000, 1000, 0, 0];\n      },\n      getValueAt: function (point) {\n        var value;\n        var shadowCtx = this.shadowCtx;\n        var img = shadowCtx.getImageData(point.x, point.y, 1, 1);\n        var data = img.data[3];\n        var max = this._max;\n        var min = this._min;\n        value = Math.abs(max - min) * (data / 255) >> 0;\n        return value;\n      },\n      getDataURL: function () {\n        return this.canvas.toDataURL();\n      }\n    };\n    return Canvas2dRenderer;\n  }();\n\n  var Renderer = function RendererClosure() {\n    var rendererFn = false;\n\n    if (HeatmapConfig['defaultRenderer'] === 'canvas2d') {\n      rendererFn = Canvas2dRenderer;\n    }\n\n    return rendererFn;\n  }();\n\n  var Util = {\n    merge: function () {\n      var merged = {};\n      var argsLen = arguments.length;\n\n      for (var i = 0; i < argsLen; i++) {\n        var obj = arguments[i];\n\n        for (var key in obj) {\n          merged[key] = obj[key];\n        }\n      }\n\n      return merged;\n    }\n  }; // Heatmap Constructor\n\n  var Heatmap = function HeatmapClosure() {\n    var Coordinator = function CoordinatorClosure() {\n      function Coordinator() {\n        this.cStore = {};\n      }\n\n      ;\n      Coordinator.prototype = {\n        on: function (evtName, callback, scope) {\n          var cStore = this.cStore;\n\n          if (!cStore[evtName]) {\n            cStore[evtName] = [];\n          }\n\n          cStore[evtName].push(function (data) {\n            return callback.call(scope, data);\n          });\n        },\n        emit: function (evtName, data) {\n          var cStore = this.cStore;\n\n          if (cStore[evtName]) {\n            var len = cStore[evtName].length;\n\n            for (var i = 0; i < len; i++) {\n              var callback = cStore[evtName][i];\n              callback(data);\n            }\n          }\n        }\n      };\n      return Coordinator;\n    }();\n\n    var _connect = function (scope) {\n      var renderer = scope._renderer;\n      var coordinator = scope._coordinator;\n      var store = scope._store;\n      coordinator.on('renderpartial', renderer.renderPartial, renderer);\n      coordinator.on('renderall', renderer.renderAll, renderer);\n      coordinator.on('extremachange', function (data) {\n        scope._config.onExtremaChange && scope._config.onExtremaChange({\n          min: data.min,\n          max: data.max,\n          gradient: scope._config['gradient'] || scope._config['defaultGradient']\n        });\n      });\n      store.setCoordinator(coordinator);\n    };\n\n    function Heatmap() {\n      var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});\n      this._coordinator = new Coordinator();\n\n      if (config['plugin']) {\n        var pluginToLoad = config['plugin'];\n\n        if (!HeatmapConfig.plugins[pluginToLoad]) {\n          throw new Error('Plugin \\'' + pluginToLoad + '\\' not found. Maybe it was not registered.');\n        } else {\n          var plugin = HeatmapConfig.plugins[pluginToLoad]; // set plugin renderer and store\n\n          this._renderer = new plugin.renderer(config);\n          this._store = new plugin.store(config);\n        }\n      } else {\n        this._renderer = new Renderer(config);\n        this._store = new Store(config);\n      }\n\n      _connect(this);\n    }\n\n    ; // @TODO:\n    // add API documentation\n\n    Heatmap.prototype = {\n      addData: function () {\n        this._store.addData.apply(this._store, arguments);\n\n        return this;\n      },\n      removeData: function () {\n        this._store.removeData && this._store.removeData.apply(this._store, arguments);\n        return this;\n      },\n      setData: function () {\n        this._store.setData.apply(this._store, arguments);\n\n        return this;\n      },\n      setDataMax: function () {\n        this._store.setDataMax.apply(this._store, arguments);\n\n        return this;\n      },\n      setDataMin: function () {\n        this._store.setDataMin.apply(this._store, arguments);\n\n        return this;\n      },\n      configure: function (config) {\n        this._config = Util.merge(this._config, config);\n\n        this._renderer.updateConfig(this._config);\n\n        this._coordinator.emit('renderall', this._store._getInternalData());\n\n        return this;\n      },\n      repaint: function () {\n        this._coordinator.emit('renderall', this._store._getInternalData());\n\n        return this;\n      },\n      getData: function () {\n        return this._store.getData();\n      },\n      getDataURL: function () {\n        return this._renderer.getDataURL();\n      },\n      getValueAt: function (point) {\n        if (this._store.getValueAt) {\n          return this._store.getValueAt(point);\n        } else if (this._renderer.getValueAt) {\n          return this._renderer.getValueAt(point);\n        } else {\n          return null;\n        }\n      }\n    };\n    return Heatmap;\n  }(); // core\n\n\n  var heatmapFactory = {\n    create: function (config) {\n      return new Heatmap(config);\n    },\n    register: function (pluginKey, plugin) {\n      HeatmapConfig.plugins[pluginKey] = plugin;\n    }\n  };\n  return heatmapFactory;\n});","map":{"version":3,"sources":["C:/Users/HorchiAbla/Desktop/dashboard1/node_modules/heatmap.js/build/heatmap.js"],"names":["name","context","factory","module","exports","define","amd","HeatmapConfig","defaultRadius","defaultRenderer","defaultGradient","defaultMaxOpacity","defaultMinOpacity","defaultBlur","defaultXField","defaultYField","defaultValueField","plugins","Store","StoreClosure","config","_coordinator","_data","_radi","_min","_max","_xField","_yField","_valueField","_cfgRadius","prototype","_organiseData","dataPoint","forceRender","x","y","radi","store","max","min","value","radius","storedVal","setDataMax","setDataMin","_unOrganizeData","unorganizedData","data","push","_onExtremaChange","emit","addData","arguments","length","dataArr","dataLen","call","organisedEntry","setData","dataPoints","pointsLen","i","_getInternalData","removeData","setCoordinator","coordinator","getData","Canvas2dRenderer","Canvas2dRendererClosure","_getColorPalette","gradientConfig","gradient","paletteCanvas","document","createElement","paletteCtx","getContext","width","height","createLinearGradient","key","addColorStop","fillStyle","fillRect","getImageData","_getPointTemplate","blurFactor","tplCanvas","tplCtx","beginPath","arc","Math","PI","fill","createRadialGradient","_prepareData","renderData","xValues","Object","keys","xValuesLen","xValue","yValues","yValuesLen","yValue","container","shadowCanvas","canvas","renderBoundaries","_renderBoundaries","computed","getComputedStyle","className","_width","replace","_height","shadowCtx","ctx","style","cssText","position","appendChild","_palette","_templates","_setStyles","renderPartial","_drawAlpha","_colorize","renderAll","_clear","_updateGradient","updateConfig","setDimensions","clearRect","_blur","blur","backgroundColor","_opacity","opacity","_maxOpacity","maxOpacity","_minOpacity","minOpacity","_useGradientOpacity","useGradientOpacity","point","rectX","rectY","tpl","templateAlpha","globalAlpha","drawImage","maxWidth","maxHeight","img","imgData","len","palette","alpha","offset","finalAlpha","putImageData","getValueAt","abs","getDataURL","toDataURL","Renderer","RendererClosure","rendererFn","Util","merge","merged","argsLen","obj","Heatmap","HeatmapClosure","Coordinator","CoordinatorClosure","cStore","on","evtName","callback","scope","_connect","renderer","_renderer","_store","_config","onExtremaChange","pluginToLoad","Error","plugin","apply","configure","repaint","heatmapFactory","create","register","pluginKey"],"mappings":"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","sourcesContent":["/*\n * heatmap.js v2.0.5 | JavaScript Heatmap Library\n *\n * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.\n * Dual licensed under MIT and Beerware license \n *\n * :: 2016-09-05 01:16\n */\n;(function (name, context, factory) {\n\n  // Supports UMD. AMD, CommonJS/Node.js and browser context\n  if (typeof module !== \"undefined\" && module.exports) {\n    module.exports = factory();\n  } else if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else {\n    context[name] = factory();\n  }\n\n})(\"h337\", this, function () {\n\n// Heatmap Config stores default values and will be merged with instance config\nvar HeatmapConfig = {\n  defaultRadius: 40,\n  defaultRenderer: 'canvas2d',\n  defaultGradient: { 0.25: \"rgb(0,0,255)\", 0.55: \"rgb(0,255,0)\", 0.85: \"yellow\", 1.0: \"rgb(255,0,0)\"},\n  defaultMaxOpacity: 1,\n  defaultMinOpacity: 0,\n  defaultBlur: .85,\n  defaultXField: 'x',\n  defaultYField: 'y',\n  defaultValueField: 'value', \n  plugins: {}\n};\nvar Store = (function StoreClosure() {\n\n  var Store = function Store(config) {\n    this._coordinator = {};\n    this._data = [];\n    this._radi = [];\n    this._min = 10;\n    this._max = 1;\n    this._xField = config['xField'] || config.defaultXField;\n    this._yField = config['yField'] || config.defaultYField;\n    this._valueField = config['valueField'] || config.defaultValueField;\n\n    if (config[\"radius\"]) {\n      this._cfgRadius = config[\"radius\"];\n    }\n  };\n\n  var defaultRadius = HeatmapConfig.defaultRadius;\n\n  Store.prototype = {\n    // when forceRender = false -> called from setData, omits renderall event\n    _organiseData: function(dataPoint, forceRender) {\n        var x = dataPoint[this._xField];\n        var y = dataPoint[this._yField];\n        var radi = this._radi;\n        var store = this._data;\n        var max = this._max;\n        var min = this._min;\n        var value = dataPoint[this._valueField] || 1;\n        var radius = dataPoint.radius || this._cfgRadius || defaultRadius;\n\n        if (!store[x]) {\n          store[x] = [];\n          radi[x] = [];\n        }\n\n        if (!store[x][y]) {\n          store[x][y] = value;\n          radi[x][y] = radius;\n        } else {\n          store[x][y] += value;\n        }\n        var storedVal = store[x][y];\n\n        if (storedVal > max) {\n          if (!forceRender) {\n            this._max = storedVal;\n          } else {\n            this.setDataMax(storedVal);\n          }\n          return false;\n        } else if (storedVal < min) {\n          if (!forceRender) {\n            this._min = storedVal;\n          } else {\n            this.setDataMin(storedVal);\n          }\n          return false;\n        } else {\n          return { \n            x: x, \n            y: y,\n            value: value, \n            radius: radius,\n            min: min,\n            max: max \n          };\n        }\n    },\n    _unOrganizeData: function() {\n      var unorganizedData = [];\n      var data = this._data;\n      var radi = this._radi;\n\n      for (var x in data) {\n        for (var y in data[x]) {\n\n          unorganizedData.push({\n            x: x,\n            y: y,\n            radius: radi[x][y],\n            value: data[x][y]\n          });\n\n        }\n      }\n      return {\n        min: this._min,\n        max: this._max,\n        data: unorganizedData\n      };\n    },\n    _onExtremaChange: function() {\n      this._coordinator.emit('extremachange', {\n        min: this._min,\n        max: this._max\n      });\n    },\n    addData: function() {\n      if (arguments[0].length > 0) {\n        var dataArr = arguments[0];\n        var dataLen = dataArr.length;\n        while (dataLen--) {\n          this.addData.call(this, dataArr[dataLen]);\n        }\n      } else {\n        // add to store  \n        var organisedEntry = this._organiseData(arguments[0], true);\n        if (organisedEntry) {\n          // if it's the first datapoint initialize the extremas with it\n          if (this._data.length === 0) {\n            this._min = this._max = organisedEntry.value;\n          }\n          this._coordinator.emit('renderpartial', {\n            min: this._min,\n            max: this._max,\n            data: [organisedEntry]\n          });\n        }\n      }\n      return this;\n    },\n    setData: function(data) {\n      var dataPoints = data.data;\n      var pointsLen = dataPoints.length;\n\n\n      // reset data arrays\n      this._data = [];\n      this._radi = [];\n\n      for(var i = 0; i < pointsLen; i++) {\n        this._organiseData(dataPoints[i], false);\n      }\n      this._max = data.max;\n      this._min = data.min || 0;\n      \n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    removeData: function() {\n      // TODO: implement\n    },\n    setDataMax: function(max) {\n      this._max = max;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setDataMin: function(min) {\n      this._min = min;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setCoordinator: function(coordinator) {\n      this._coordinator = coordinator;\n    },\n    _getInternalData: function() {\n      return { \n        max: this._max,\n        min: this._min, \n        data: this._data,\n        radi: this._radi \n      };\n    },\n    getData: function() {\n      return this._unOrganizeData();\n    }/*,\n\n      TODO: rethink.\n\n    getValueAt: function(point) {\n      var value;\n      var radius = 100;\n      var x = point.x;\n      var y = point.y;\n      var data = this._data;\n\n      if (data[x] && data[x][y]) {\n        return data[x][y];\n      } else {\n        var values = [];\n        // radial search for datapoints based on default radius\n        for(var distance = 1; distance < radius; distance++) {\n          var neighbors = distance * 2 +1;\n          var startX = x - distance;\n          var startY = y - distance;\n\n          for(var i = 0; i < neighbors; i++) {\n            for (var o = 0; o < neighbors; o++) {\n              if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {\n                if (data[startY+i] && data[startY+i][startX+o]) {\n                  values.push(data[startY+i][startX+o]);\n                }\n              } else {\n                continue;\n              } \n            }\n          }\n        }\n        if (values.length > 0) {\n          return Math.max.apply(Math, values);\n        }\n      }\n      return false;\n    }*/\n  };\n\n\n  return Store;\n})();\n\nvar Canvas2dRenderer = (function Canvas2dRendererClosure() {\n\n  var _getColorPalette = function(config) {\n    var gradientConfig = config.gradient || config.defaultGradient;\n    var paletteCanvas = document.createElement('canvas');\n    var paletteCtx = paletteCanvas.getContext('2d');\n\n    paletteCanvas.width = 256;\n    paletteCanvas.height = 1;\n\n    var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);\n    for (var key in gradientConfig) {\n      gradient.addColorStop(key, gradientConfig[key]);\n    }\n\n    paletteCtx.fillStyle = gradient;\n    paletteCtx.fillRect(0, 0, 256, 1);\n\n    return paletteCtx.getImageData(0, 0, 256, 1).data;\n  };\n\n  var _getPointTemplate = function(radius, blurFactor) {\n    var tplCanvas = document.createElement('canvas');\n    var tplCtx = tplCanvas.getContext('2d');\n    var x = radius;\n    var y = radius;\n    tplCanvas.width = tplCanvas.height = radius*2;\n\n    if (blurFactor == 1) {\n      tplCtx.beginPath();\n      tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);\n      tplCtx.fillStyle = 'rgba(0,0,0,1)';\n      tplCtx.fill();\n    } else {\n      var gradient = tplCtx.createRadialGradient(x, y, radius*blurFactor, x, y, radius);\n      gradient.addColorStop(0, 'rgba(0,0,0,1)');\n      gradient.addColorStop(1, 'rgba(0,0,0,0)');\n      tplCtx.fillStyle = gradient;\n      tplCtx.fillRect(0, 0, 2*radius, 2*radius);\n    }\n\n\n\n    return tplCanvas;\n  };\n\n  var _prepareData = function(data) {\n    var renderData = [];\n    var min = data.min;\n    var max = data.max;\n    var radi = data.radi;\n    var data = data.data;\n\n    var xValues = Object.keys(data);\n    var xValuesLen = xValues.length;\n\n    while(xValuesLen--) {\n      var xValue = xValues[xValuesLen];\n      var yValues = Object.keys(data[xValue]);\n      var yValuesLen = yValues.length;\n      while(yValuesLen--) {\n        var yValue = yValues[yValuesLen];\n        var value = data[xValue][yValue];\n        var radius = radi[xValue][yValue];\n        renderData.push({\n          x: xValue,\n          y: yValue,\n          value: value,\n          radius: radius\n        });\n      }\n    }\n\n    return {\n      min: min,\n      max: max,\n      data: renderData\n    };\n  };\n\n\n  function Canvas2dRenderer(config) {\n    var container = config.container;\n    var shadowCanvas = this.shadowCanvas = document.createElement('canvas');\n    var canvas = this.canvas = config.canvas || document.createElement('canvas');\n    var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];\n\n    var computed = getComputedStyle(config.container) || {};\n\n    canvas.className = 'heatmap-canvas';\n\n    this._width = canvas.width = shadowCanvas.width = config.width || +(computed.width.replace(/px/,''));\n    this._height = canvas.height = shadowCanvas.height = config.height || +(computed.height.replace(/px/,''));\n\n    this.shadowCtx = shadowCanvas.getContext('2d');\n    this.ctx = canvas.getContext('2d');\n\n    // @TODO:\n    // conditional wrapper\n\n    canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';\n\n    container.style.position = 'relative';\n    container.appendChild(canvas);\n\n    this._palette = _getColorPalette(config);\n    this._templates = {};\n\n    this._setStyles(config);\n  };\n\n  Canvas2dRenderer.prototype = {\n    renderPartial: function(data) {\n      if (data.data.length > 0) {\n        this._drawAlpha(data);\n        this._colorize();\n      }\n    },\n    renderAll: function(data) {\n      // reset render boundaries\n      this._clear();\n      if (data.data.length > 0) {\n        this._drawAlpha(_prepareData(data));\n        this._colorize();\n      }\n    },\n    _updateGradient: function(config) {\n      this._palette = _getColorPalette(config);\n    },\n    updateConfig: function(config) {\n      if (config['gradient']) {\n        this._updateGradient(config);\n      }\n      this._setStyles(config);\n    },\n    setDimensions: function(width, height) {\n      this._width = width;\n      this._height = height;\n      this.canvas.width = this.shadowCanvas.width = width;\n      this.canvas.height = this.shadowCanvas.height = height;\n    },\n    _clear: function() {\n      this.shadowCtx.clearRect(0, 0, this._width, this._height);\n      this.ctx.clearRect(0, 0, this._width, this._height);\n    },\n    _setStyles: function(config) {\n      this._blur = (config.blur == 0)?0:(config.blur || config.defaultBlur);\n\n      if (config.backgroundColor) {\n        this.canvas.style.backgroundColor = config.backgroundColor;\n      }\n\n      this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;\n      this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;\n\n\n      this._opacity = (config.opacity || 0) * 255;\n      this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;\n      this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;\n      this._useGradientOpacity = !!config.useGradientOpacity;\n    },\n    _drawAlpha: function(data) {\n      var min = this._min = data.min;\n      var max = this._max = data.max;\n      var data = data.data || [];\n      var dataLen = data.length;\n      // on a point basis?\n      var blur = 1 - this._blur;\n\n      while(dataLen--) {\n\n        var point = data[dataLen];\n\n        var x = point.x;\n        var y = point.y;\n        var radius = point.radius;\n        // if value is bigger than max\n        // use max as value\n        var value = Math.min(point.value, max);\n        var rectX = x - radius;\n        var rectY = y - radius;\n        var shadowCtx = this.shadowCtx;\n\n\n\n\n        var tpl;\n        if (!this._templates[radius]) {\n          this._templates[radius] = tpl = _getPointTemplate(radius, blur);\n        } else {\n          tpl = this._templates[radius];\n        }\n        // value from minimum / value range\n        // => [0, 1]\n        var templateAlpha = (value-min)/(max-min);\n        // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData\n        shadowCtx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;\n\n        shadowCtx.drawImage(tpl, rectX, rectY);\n\n        // update renderBoundaries\n        if (rectX < this._renderBoundaries[0]) {\n            this._renderBoundaries[0] = rectX;\n          }\n          if (rectY < this._renderBoundaries[1]) {\n            this._renderBoundaries[1] = rectY;\n          }\n          if (rectX + 2*radius > this._renderBoundaries[2]) {\n            this._renderBoundaries[2] = rectX + 2*radius;\n          }\n          if (rectY + 2*radius > this._renderBoundaries[3]) {\n            this._renderBoundaries[3] = rectY + 2*radius;\n          }\n\n      }\n    },\n    _colorize: function() {\n      var x = this._renderBoundaries[0];\n      var y = this._renderBoundaries[1];\n      var width = this._renderBoundaries[2] - x;\n      var height = this._renderBoundaries[3] - y;\n      var maxWidth = this._width;\n      var maxHeight = this._height;\n      var opacity = this._opacity;\n      var maxOpacity = this._maxOpacity;\n      var minOpacity = this._minOpacity;\n      var useGradientOpacity = this._useGradientOpacity;\n\n      if (x < 0) {\n        x = 0;\n      }\n      if (y < 0) {\n        y = 0;\n      }\n      if (x + width > maxWidth) {\n        width = maxWidth - x;\n      }\n      if (y + height > maxHeight) {\n        height = maxHeight - y;\n      }\n\n      var img = this.shadowCtx.getImageData(x, y, width, height);\n      var imgData = img.data;\n      var len = imgData.length;\n      var palette = this._palette;\n\n\n      for (var i = 3; i < len; i+= 4) {\n        var alpha = imgData[i];\n        var offset = alpha * 4;\n\n\n        if (!offset) {\n          continue;\n        }\n\n        var finalAlpha;\n        if (opacity > 0) {\n          finalAlpha = opacity;\n        } else {\n          if (alpha < maxOpacity) {\n            if (alpha < minOpacity) {\n              finalAlpha = minOpacity;\n            } else {\n              finalAlpha = alpha;\n            }\n          } else {\n            finalAlpha = maxOpacity;\n          }\n        }\n\n        imgData[i-3] = palette[offset];\n        imgData[i-2] = palette[offset + 1];\n        imgData[i-1] = palette[offset + 2];\n        imgData[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;\n\n      }\n\n      img.data = imgData;\n      this.ctx.putImageData(img, x, y);\n\n      this._renderBoundaries = [1000, 1000, 0, 0];\n\n    },\n    getValueAt: function(point) {\n      var value;\n      var shadowCtx = this.shadowCtx;\n      var img = shadowCtx.getImageData(point.x, point.y, 1, 1);\n      var data = img.data[3];\n      var max = this._max;\n      var min = this._min;\n\n      value = (Math.abs(max-min) * (data/255)) >> 0;\n\n      return value;\n    },\n    getDataURL: function() {\n      return this.canvas.toDataURL();\n    }\n  };\n\n\n  return Canvas2dRenderer;\n})();\n\n\nvar Renderer = (function RendererClosure() {\n\n  var rendererFn = false;\n\n  if (HeatmapConfig['defaultRenderer'] === 'canvas2d') {\n    rendererFn = Canvas2dRenderer;\n  }\n\n  return rendererFn;\n})();\n\n\nvar Util = {\n  merge: function() {\n    var merged = {};\n    var argsLen = arguments.length;\n    for (var i = 0; i < argsLen; i++) {\n      var obj = arguments[i]\n      for (var key in obj) {\n        merged[key] = obj[key];\n      }\n    }\n    return merged;\n  }\n};\n// Heatmap Constructor\nvar Heatmap = (function HeatmapClosure() {\n\n  var Coordinator = (function CoordinatorClosure() {\n\n    function Coordinator() {\n      this.cStore = {};\n    };\n\n    Coordinator.prototype = {\n      on: function(evtName, callback, scope) {\n        var cStore = this.cStore;\n\n        if (!cStore[evtName]) {\n          cStore[evtName] = [];\n        }\n        cStore[evtName].push((function(data) {\n            return callback.call(scope, data);\n        }));\n      },\n      emit: function(evtName, data) {\n        var cStore = this.cStore;\n        if (cStore[evtName]) {\n          var len = cStore[evtName].length;\n          for (var i=0; i<len; i++) {\n            var callback = cStore[evtName][i];\n            callback(data);\n          }\n        }\n      }\n    };\n\n    return Coordinator;\n  })();\n\n\n  var _connect = function(scope) {\n    var renderer = scope._renderer;\n    var coordinator = scope._coordinator;\n    var store = scope._store;\n\n    coordinator.on('renderpartial', renderer.renderPartial, renderer);\n    coordinator.on('renderall', renderer.renderAll, renderer);\n    coordinator.on('extremachange', function(data) {\n      scope._config.onExtremaChange &&\n      scope._config.onExtremaChange({\n        min: data.min,\n        max: data.max,\n        gradient: scope._config['gradient'] || scope._config['defaultGradient']\n      });\n    });\n    store.setCoordinator(coordinator);\n  };\n\n\n  function Heatmap() {\n    var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});\n    this._coordinator = new Coordinator();\n    if (config['plugin']) {\n      var pluginToLoad = config['plugin'];\n      if (!HeatmapConfig.plugins[pluginToLoad]) {\n        throw new Error('Plugin \\''+ pluginToLoad + '\\' not found. Maybe it was not registered.');\n      } else {\n        var plugin = HeatmapConfig.plugins[pluginToLoad];\n        // set plugin renderer and store\n        this._renderer = new plugin.renderer(config);\n        this._store = new plugin.store(config);\n      }\n    } else {\n      this._renderer = new Renderer(config);\n      this._store = new Store(config);\n    }\n    _connect(this);\n  };\n\n  // @TODO:\n  // add API documentation\n  Heatmap.prototype = {\n    addData: function() {\n      this._store.addData.apply(this._store, arguments);\n      return this;\n    },\n    removeData: function() {\n      this._store.removeData && this._store.removeData.apply(this._store, arguments);\n      return this;\n    },\n    setData: function() {\n      this._store.setData.apply(this._store, arguments);\n      return this;\n    },\n    setDataMax: function() {\n      this._store.setDataMax.apply(this._store, arguments);\n      return this;\n    },\n    setDataMin: function() {\n      this._store.setDataMin.apply(this._store, arguments);\n      return this;\n    },\n    configure: function(config) {\n      this._config = Util.merge(this._config, config);\n      this._renderer.updateConfig(this._config);\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    repaint: function() {\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    getData: function() {\n      return this._store.getData();\n    },\n    getDataURL: function() {\n      return this._renderer.getDataURL();\n    },\n    getValueAt: function(point) {\n\n      if (this._store.getValueAt) {\n        return this._store.getValueAt(point);\n      } else  if (this._renderer.getValueAt) {\n        return this._renderer.getValueAt(point);\n      } else {\n        return null;\n      }\n    }\n  };\n\n  return Heatmap;\n\n})();\n\n\n// core\nvar heatmapFactory = {\n  create: function(config) {\n    return new Heatmap(config);\n  },\n  register: function(pluginKey, plugin) {\n    HeatmapConfig.plugins[pluginKey] = plugin;\n  }\n};\n\nreturn heatmapFactory;\n\n\n});"]},"metadata":{},"sourceType":"script"}